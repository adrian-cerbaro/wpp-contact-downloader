/*! wpp-contact-downloader 2020-03-21 */

(()=>{let e=[],t=document.getElementsByClassName("rK2ei")[0].getElementsByClassName("_1v8mQ");for(let n=0;n<t.length;n++){let a=t[n],m=a.getElementsByTagName("img").length>0?a.getElementsByTagName("img")[0].src:"",s=a.getElementsByClassName("_3H4MS")[0].getElementsByTagName("span")[0].title,o=a.getElementsByClassName("_1VwzF")[0].getElementsByClassName("_22OEK")[0].getElementsByClassName("_F7Vk")[0].innerText,g="",i="";l(o)?g=o:i=o,e.push({nome:s,numero:i,email:g,foto:m})}let n="";for(let t=0;t<e.length;t++){let l=e[t];n+=`${l.nome},${l.numero},${l.email}\r\n`}function l(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}!function(e,t){let n=new Blob([t],{type:"text/csv"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,e);else{let t=window.document.createElement("a");t.href=window.URL.createObjectURL(n),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}("contatos.csv",n)})();